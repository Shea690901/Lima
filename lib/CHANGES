Changes since Lima 1.0b1
=========================

Tigran updated help release

Tigran modified compile() in LPSCRIPT_D so that it will not regenerate the tmp file if the tmp file is newer than the source file.

Tigran made a change to SOCKET to utilize an updated socket_address() efun

Tigran added a local_address() function to SOCKET (That's harder to get than you might think and this way is better)

Tigran made various modifications to FTP_D to remove resolve() calls that are no longer necessary with the recent SOCKET modifications

Tigran fixed FTP_D to return an empty list when trying to ls <filename>/. rather than a 550 error.  The other way worked, but was not what is proper. (This still isn't perfect, but it's much much closer.  It's not an error now, but still gives an extra linefeed, which may be acceptable)

Loriel fixed BODY (/std/body.c) to inherit /std/body/skills.c (subject to the define USE_SKILLS), removing comments and fixing a typo.

Loriel fixed M_ITEMS (/std/modules/m_items.c), changing "long" to "look" in line 43.

Tigran fixed a typo in M_EXIT on line 327.  query_method_destination should be query_method_description

Tigran made a modification to M_EXIT to automatically append a \n to an exit description if it does not already have one.  (lines 341,342 added)

Tigran modified the look verb so that you can now look at exits.  This means that exits can be described with set_exit_description(dir,desc) from the room.  (This function is smart enough to set the long of complex exits as well though not preferred and may change).  add_item()'s will still error if you add_item() an item with the same name as a simple exit(which shouldn't happen).

Loriel fixed the typo "bask" to "back" in /domains/std/Example_Room1.c

Loriel extended /include/combat_modules.h to handle FORMULA_STATS.

Loriel extended /std/adversary/mod_config.c to recognise FORMULA_STATS as a valid option.

Tigran (re)installed the colours command that works without the CONFIGURABLE_COLOUR define that was removed a /long/ time ago

Loriel fixed /domains/std/table.c, changing the inherit from COMPLEX_CONTAINER to CONTAINER and added a default relation of "on" (Thanks to Jonez for pointing this out).

Loriel amended PLAYER_MENU (/obj/mudlib/plmemu.c) to better handle prompting to change the ansi setting, by adding an intermediate function prompt_change_ansi() (problem and solution courtesy of Jonez).

Tigran added some additional LPSCRIPT functionality to OBJECT>  Objects now retain their lpscript_attributes after first use so that they do not have to be recalculated every time an lpscript object is loaded.  A list of lpscript_attributes for a given object can also be acquired with list_lpscript_attributes().  A copy of the mapping is attained through dump_lpscript_attributes().

Loriel changed the north exit in /domains/std/cult/Foyer.c from ../room2 to ../Relations_And_Toys. Thanks to Marroc for pointing this out.

Loriel amended /trans/cmds/cat.c, changing line 22 to avoid looping on an empty string when reading a null file.  Thanks to Rakk for pointing out the problem.

Tigran added go down as an equivalent to descend and 'go up' as an equivalent to 'ascend' in METHOD_D

Tigran added has_method() to M_COMPLEX_EXIT

Tigran rewrote STAIRS.  This may be a bit of a compat buster, but I don't think so.  It is no longer necessary for STAIRS to have arguments passed to it's crete/setup() in order for them to properly function.

Tigran fixed /std/object/names.c so that add_adjective will set a primary_adjective if one does not already exisdt.

Tigran added the verbs ascend and descend

Tigran fixed DOC_D to check for existing directories before creating new ones.

Tigran fixed M_READABLE at Loriel's suggestion just over a year ago (Line 60, in set_text())

Loriel amended /std/adversary/wield/multiple.c, adding a check for empty slots into query_weapon() as suggested by Designa.

Loriel made 3 fixes in M_FILE (/secure/modules/m_file.c) for problems pointed out by Seven - line 37, line 174 and line 183.

Iizuka added LIMB_ATTACKING to /include/limbs.h and added query_attacking_limbs() to /std/adversary/health/limbs.c.

Iizuka updated /obj/admtool/daemons/body.c with respect to attacking limbs.

Loriel amended /obj/admtool/daemons/body.c, inserting parent in finish_add_limb() - line 58.

Loriel amended BODY_D (/daemons/body_d.c) adding the setting of parent into add_limb_to_body().

Loriel added is_attacking_limb() into /std/adversary/health/limbs.c.

Loriel changed STR to STRINGIZE in /std/classes/event_info.c to comply with the correct usage enforced in newer drivers (v22.2b5 onwards).

Loriel improved /obj/admtool/daemons/body.c, fixing the description of the 'r' option (remove limb) to distinguish it from 'R' (remove body), and added attacking to the valid limb types referred to in line 93 in set_limb_flags().

Loriel added a check for valid body type into add_limb_to_body() in BODY_D (/daemons/body_d.c).

Loriel amended "/bulders/" to "/wiz/" in DOC_D (/daemons/doc_d.c). Thanks to Marroc for spotting it.

Loriel improved the messaging in do_diagnose_liv() in /cmds/verbs/diagnose.c, to avoid others in the room seeing full details - problem reported by Krant.

Loriel fixed the typo in line 90 of NON_ROOM (/std/non_room.c) pointed out by Krant : ..RESET^.. -> ..RESET%%^..

Loriel changed data from int to mixed in class event_info in /std/classes/event_info/simple.c (pointed out by Argon).

Iizuka removed /std/accountant.c and removed ACCOUNTANT from /include/mudlib.h.

Iizuka installed /std/modules/m_accountant.c and added M_ACCOUNTANT to /include/mudlib.h.

Iizuka updated /domains/std/bank_accountant.c with respect to the last two changelogs.

Iizuka installed /std/accountant.c.  This solves the LPscript problem reported by Marroc.  This assumes adversary, so if you want one from living either modify this or make a similar object using living instead.

Loriel fixed follow_hook() in M_FOLLOW (/std/modules/m_follow.c) to improve following, including support for function pointers and better checking.

Iizuka removed add_save() from /std/armor.c and moved it to /std/modules/m_wearable.c, as Marroc suggested.  m_wearable now has a mudlib_setup().

Deathblade fixed a bug! whee! the LPSCRIPT_D / ACCOUNTANT thing. solution was posted by Marroc a couple weeks ago to lima.bugs. It prevented a clean login for me on a fresh mud reboot... had to be fixed :-)

Deathblade put /daemons/imud/channel.c back to its original pre-bogus state. Minus three cool points to whoever borked it up. Lima can now speak on I3 channels.

Deathblade added a comment to imud_d.c about us-1.i3.intermud.org being the router address. would be nice if somebody could change imud_d.c to use a hostname rather than a bare IP

Loriel moved "help release" from /help/wizard/ to /help/player/ so visitors can see it without being auto-wizzed.

Loriel amended get_size() to query_size() in /domains/std/rooms/beach/Outside_Cave.c. Thanks to Marroc for pointing it out.

Deathblade added a comment about router_list to imud_d.c to inform newless clubies that it really *is* intended to be saved. (*cough kesac*  ahem)

Deathblade updated USAGE. christ was that an old email address.

Loriel amended GUILD_D (/daemons/guild_d.c) so that admtool does not give privilege problems, by allowing changes where that is the previous object as well as where the check_previous_privilege() test is passed.

Tigran fixed a typo in master.c line 372 adjectiv->adjective

Loriel updated the help on parse_command_adjective_id_list, following the correction of spelling - see /help/wizard/mudos_doc/applies/parsing/.

Loriel fixed the "no do_* function in /cmds/verbs/go!" error by changing the spelling of do_go_word_obj() to do_go_wrd_obj().

Loriel further amended /cmds/verbs/go.c, adding a can_go_wrd_obj() returning "You can't do that!\n"

Loriel amended /help/release/player to show the new (temporary) download site available by courtesy of Rust : http://pip.list.org/~viega/lima-1.0b1+driver.tar.gz

Iizuka installed very simple docs for adversary in /help/wizard/lib/std/

Loriel amended DOOR (/std/door.c), changing the messaging in door_check() as proposed by Marroc, namely deleting this_body() from the arguments of the other_action() and changing dir to the_short() in the returned sprintf().

Loriel rearranged the "screwed up" help files on test_bit/next_bit/set_bit, in /help/wizard/mudos_doc/efuns/strings. Thanks to Pan for pointing it out.

Loriel amended /std/adversary/blows/base.c, adding a check for queue[i]->target into line 113.

Loriel amended COMBAT_SPELL (/std/combat_spell.c), changing the final argument to evaluate(damage_func).

Loriel amended /domains/std/spells/fireball.c to use more appropriate message and damage types.

Loriel amended /std/objects/names.c, setting primary_id to 0 in remove_id() and clear_id(), and setting primary_adj to 0 in remove_adj() and clear_adj(), as suggested by Marroc.

Loriel changed pick() to do_pick() in M_LOCKABLE (/std/modules/m_lockable.c), as suggested by Marroc.

Loriel added a default failure in direct_look_wrd_obj() in /std/object/vsupport.c, as suggested by Marroc.

Loriel amended the 'helper functions' page_before() and page_after() in BOOK (/std/book.c), as suggested by Marroc (under the misleading heading 'DOOR'.

Loriel amended the portal setting in setup() in WIZ_ROOM (/domains/std/Wizroom.c) from START to "/domains/std/rooms/beach/Sandy_Beach.c" as suggested by Marroc.

Loriel amended M_AGGRESSIVE (/std/modules/m_aggressive.c), adding functions agro_fn = (: agro_func :) and moved_fn = (: i_moved :) to ensure hooks are removed properly as required.

Loriel amended /secure/user/login.c to use choice() in selecting alternate welcome screens, and to check there are files available before doing so.

Loriel amended /cmds/wiz/didlog.c so that the /on and /off options use this_user()->set_didlog_off() instead of this_body()->set_ilog_off().

Loriel amended someone_did() in DID_D (/daemons/did_d.c) to send messages to users, instead of bodies.

Loriel changed M_COMPLEX_EXIT (/std/modules/m_complex_exit.c), changing the pattern for Destination from %s to %O in stat_me().

Loriel fixed VEHICLE (/std/vehicle.c) by removing a stray comma from "person_left," in mudlib_setup().

Loriel amended /std/adversary/advancement/simple.c, changing use of this_body() to this_object().

Loriel amended HIDDEN_DOOR (/std/hidden_door.c) to use set_hidden() rather than add/remove_hidden_exit(), as suggested by Marroc.

Loriel amended M_EXIT (/std/modules/m_exit.c) as suggeted by Marroc, using query_hidden_exits() instead of hidden_exits in the function show_exits().

Loriel amended M_SIBLING (/std/modules/m_sibling.c) as proposed by Marroc, adding set_sibling_ident() and zeroing cached_sibling in setup_sibling().

Loriel amended DOOR (/std/door.c) for Marroc's suggested replacement of respond_to_sibling_ident() by setup_sibling_ident() in setup_door().

Loriel amended /include/mudlib.h, adding (back?) the define for MOVING_ROOM.

Loriel amended various rooms and other items in /domains/std/ for door-related changes from Marroc: Wizroom.c, 2.4.5/attic.scr, 2.4.5/church.scr, 2.4.5/wiz_hall.scr, 2.4.5/elevator.c, 2.4.5/obj/elevator_button.scr, 2.4.5/obj/elevator_call_button.scr, 2.4.5/obj/elevator_door.c.

Loriel fixed problems in PLAYER_MENU (/obj/mudlib/plmenu.c) by replacing input_one_arg with get_input_then_call approx lines 270 - 290 (solution from Marroc).

Loriel amended BASE_ROOM (/std/base_room.c), removing the invalid LPscript attribute "default exit" (as pointed out by Marroc), and adding support for room chats, plus support for verbs smell, and pray in the room, as well as proving set_listen() to set the message for listening in the room.

Loriel added /cmds/verbs/pray.c to support prayers for resurrection (with the NEED_TO_BE_ALIVE flag cleared).

Loriel extended /cmds/verbs/smell.c to support the simple 'smell' and using do_smell() in the environment.

Loriel added support for speaking from within containers in rooms to /cmds/players/say.c and /cmds/verbs/say.c (Thanks to Marroc for the code).

Loriel added Marroc's fixed versions of /cmds/players/adverbs.c and /cmds/players/feelings.c which should no longer error if SOUL_D has been cleared.

Loriel installed Marroc's amended LPSCRIPT_D (/secure/daemons/lpscript_d.c) which should fix permission problems in sub object file generation.


Changes since Lima 1.0b2
========================

Tue Feb 27 09:48:59 2001: Loriel added a further error-trap into read_entry() in M_READABLE (/std/modules/m_readable.c) to return 'nothing there' for attempts to read invalid entries, instead of erroring.

Tue Feb 27 16:35:53 2001: Loriel changed get_lowest_unread_id(current_group) to current_id in menu_select_change_header() in NEWSREADER (/obj/mudlib/newsreader.c) as suggested by Marroc.

Tue Feb 27 18:40:45 2001: Loriel installed a new ACCOUNTANT (/std/accountant.c) to use the M_ACCOUNTANT (/std/modules/m_accountant.c) module by IIzuka.

Tue Feb 27 18:43:55 2001: Loriel amended the lpscript attributes of DOOR (/std/door.c) for ident to set_sibling_ident. Thanks to Marroc for spotting it.

Tue Feb 27 19:00:04 2001: Loriel amended the door_check() function in SECRET_DOOR (/std/secret_door.c) from int to mixed, and to return the environment's get_default_exit() instead of writing it and returning 0. (suggested by Marroc)

Tue Feb 27 19:11:04 2001: Loriel finished the incomplete implementation of Marroc's fixes to PLAYER_MENU (/obj/mudlib/plmenu.c) relating to souls and adverbs.

Tue Feb 27 19:17:50 2001: Loriel fixed the spelling of parse_command_adjective_id_list() in /secure/master.c.

Wed Feb 28 09:27:43 2001: Loriel reinstalled earlier fix to GUILD_D (/daemons/guild_d.c) so that admtool does not give privilege problems, by allowing changes where that is the previous object as well as where the check_previous_privilege() test is passed.

Wed Feb 28 10:37:40 2001: Loriel amended CONTAINER (/std/container.c), adding error-trapping into reinsert_object() to assume default relation if none is specified, and commented out some of the conditions in indirect_verb_rule, and provided better error messages. Note that there are probably better checks to be added for indirect_verb_rule, but at least these correctly check basic stuff like getting from and putting in.

Thu Mar  1 09:10:06 2001: Loriel fixed the exit in /domains/std/cult/Foyer.c from ../room2 to ../Relations_And_Toys. Thanks to Marroc for pointing it out.

Thu Mar  1 09:13:22 2001: Loriel changed get_size() to query_size() in /domains/std/rooms/beach/Outside_Cave.c. Thanks to Marroc for spotting it.

Thu Mar  1 09:16:16 2001: Loriel replaced example_room1 with Example_Room1 in /domains/std/rooms/v_plains.data - thanks to Marroc for spotting it.

Thu Mar  1 09:23:36 2001: Loriel added into OBJ (/std/object.c) various lpscript support functions from Marroc.

Thu Mar  1 09:27:24 2001: Loriel replaced inheritance of COMPLEX_CONTAINER by CONTAINER in /domains/std/table.c.

Thu Mar  1 09:35:32 2001: Loriel added the saving of num_eats into a newly added mudlib_setup() in M_EDIBLE (/std/modules/m_edible.c).

Thu Mar  1 09:37:40 2001: Loriel added a new mudlib_setup() into FOOD (/std/food.c) to properly handle the two inherited mudlib_setup() functions from OBJECT and M_EDIBLE.

Thu Mar  1 09:47:25 2001: Loriel amended query_mail_forward() in NEWS_D (/daemons/news_d.c) as suggested by Marroc, to return an array, empty if no mail forward, and 0 for permission denied.

Thu Mar  1 09:47:31 2001: Loriel amended /obj/admtool/daemons/news.c to reflect the amendment above.

Thu Mar  1 09:48:55 2001: Loriel amended show_exits() in M_EXIT (/std/modules/m_exit.c), installing Marroc's fix to better handle case with all exits hidden.

Thu Mar  1 09:57:23 2001: Loriel added Marroc's proposed fix to /std/body/quests.c, returning 0 for check_quest() if there are no quests.

Fri Mar  2 08:22:25 2001: Loriel added error-checking into can_drive_str() in /cmds/verbs/drive.c so that attempting to drive whilst not in a vehicle is better handled.

Sat Mar  3 08:12:44 2001: Loriel amended CORPSE (/std/corpse.c) to remove the $v from $vgnaw in the set_decay_action() in mudlib_setup().

Mon Mar  5 08:31:06 2001: Loriel amended direct_enter_obj() in /domains/std/objects/sand_castle.c to return a suitable failure message (moving the one from do_enter()).

Tue Mar  6 19:01:26 2001: Loriel fixed /domains/std/object/dock_wall.c to use do_close instead of close in its trigger() function.

Wed Mar  7 17:50:46 2001: Loriel removed /daemons/cmd.c (unneeded - misplaced copy of /daemons/channel/cmd.c).

Sat Mar 10 10:28:46 2001: Loriel amended rcv_finger_reply() in /daemons/imud/finger.c to convert int to string for those muds which choose to break the I3 protocol by returning level as int instead of string.

Fri Mar 23 05:29:59 2001: Loriel fixed check_previous() in GUILD_D (/daemons/guild_d.c) to take the argument passed - thanks to Sarak for pointing it out.

Sun Mar 25 14:58:49 2001: Loriel added Marroc's proposed changes to /secure/master.c, to better handle errors of the 'which ... do you mean?' type, adding parser_gen_pos() and amending the ERR_AMBIG case in parser_error_message() to use it.

Tue Mar 27 08:05:31 2001: Loriel installed Marroc's recursive extension to his fix to the master for ambiguous errors - see parser_gen_pos() and parser_error_message().

Thu Mar 29 15:03:02 2001: Rust fixed it so that remote tells from others show up in your tell history.

Tue Apr 10 02:53:36 2001: Marroc created newsgroup lima.bugs.fixed, for bugreps that are supposedly fixed, so that they do not clutter the lima.bugs group.

Tue Apr 10 15:27:25 2001: Rust made it so that when I3 reports an error it tells you the mud name that sent the error.

Mon Apr 16 19:39:35 2001: Tigran tweaked HTTP_D so that it parses cgi a bit better with arguments (? vs ?=)

Tue Apr 17 05:51:51 2001: Loriel amended make_unique_objects_if_needed() in CONTAINER (/std/container.c), adding a clonep() filter and adjusting the number by 1, which should ensure correct number of unique clones created on initial cloning.

Tue Apr 17 05:55:01 2001: Loriel fixed the default fill_action in M_FLUID_SOURCE (/std/modules/m_fluid_source.c), changing withdraw to $vwithdraw.

Tue Apr 17 05:58:49 2001: Loriel amended M_READABLE (/std/modules/m_readable.c), adding set_entry_synonyms() as an alternative to set_synonyms() and adjusting the autodoc help appropriately.

Tue Apr 17 06:07:43 2001: Loriel made fixes to M_FOLLOW (/std/modules/m_follow.c), changing autodoc name of set_follow_search() from set_follow_string, adding a did_move() into do_follow_obj() and improving arrive_hook().

Mon Apr 23 02:54:55 2001: Marroc amended /cmds/player/colours.c, removing the check for CONFIGURABLE_COLOUR (this was probably fixed before, but lost).

Mon Apr 23 02:58:35 2001: Marroc added support for colours in admtool using the defined colours ADMTOOL_HEADING, ADMTOOL_HI and ADMTOOL_LO. Modified /obj/admtool/admtool2.c, /obj/admtool/internal/base.c slightly. The colours default to 'none'.

Tue Apr 24 00:38:03 2001: Marroc amended ADVERSARY (/std/adversary.c), ARMOR (/std/armor.c), CONTAINER (/std/container.c), FLAME (/std/flame.c), FOLLOWING_MONSTER (/std/following_monster.c), FOOD (/std/food.c), KEY (/std/key.c), PAPER (/std/paper.c), SIGN (/std/sign.c), TORCH (/std/torch.c), WANDERING_MONSTER (/std/wandering_monster.c) and WEAPON (/std/weapon.c) -- Eliminating calls to ::lpscript_attributes() in inherited modules etc, as they are redundant; LPSCRIPT_D digs through all the inherits by itself.

Thu May 10 14:19:49 2001: Marroc updated M_SIBLING (/std/modules/m_sibling.c) to use a function instead of a string to refer to the sibling room path, removing the need for initialisation through on_clone().

Thu May 10 14:20:07 2001: Marroc updated DOOR (/std/door.c) to reflect the changes in M_SIBLING.

Fri May 11 04:03:02 2001: Loriel added a 'destruct(ob)' into add_sell() in M_VENDOR (/std/modules/m_vendor.c) to remove items which are cloned as part of the sales process but neither used nor removed properly.

Fri May 11 05:56:38 2001: Marroc added the concept of a 'through' object in the movement system, that specifies the object through which you enter a room. This enables enter/leave msgs to make more sense, especially when one room has a "northern door" that you walk through, entering the next room through it's "southern door". Complex exit objects automatically set the 'through' object if they can find a sibling at the destination. Modified CLASS_MOVE (/std/classes/move.c), M_COMPLEX_EXIT (/std/modules/m_complex_exit.c) and M_SMARTMOVE (/std/modules/m_smartmove.c).

Fri May 11 06:09:32 2001: Marroc updated SECRET_DOOR (/std/secret_door.c), replacing call to get_default_exit() with query_default_error() so that it'll return the proper error message if trying to walk through the door without opening it (same message as if trying to walk in an invalid direction).

Fri May 11 06:11:08 2001: Marroc modified M_OPENABLE (/std/modules/m_openable.c), commenting out the code that changes adjectives of the object depending on open/closed state, as the new adjective seems to become primary, interfering with what you set in the object.

Fri May 11 07:52:59 2001: Marroc added punctiation and a newline to the return message of door_check() in DOOR (/std/door.c)

Fri May 11 08:12:09 2001: Marroc modified /std/object/names.c, moving initialisation of primary_adj to resync(), where init. of primary_id is. Also modified set_id() and set_adj() to ensure the new ids/adjs end up in the beginning of the id/adj arrays, so that primary_id/adj resync properly.

Sun May 13 16:19:06 2001: Marroc amended M_COMPLEX_EXIT (/std/modules/m_complex_exit.c), removing call to error() in complex_exit_direct_verb_rule() when rule format is unexpected. It now returns 0 now, as would seem more proper when the check cannot handle the rule.

Sun May 13 16:47:50 2001: Loriel fixed part of the 'Pirate Quest', changing "player_left" to "person_left" in on_clone() in /domains/std/objects/ocean.c, and changing the matching in award_points() to if(evaluate(direction) == "the ocean") in the same file, and set the granting object to ocean instead of room.

